<tool id="interactomix_vd2dock" name="VD2DOCK" version="0.1">
	<description>
	</description>
	<command detect_errors="exit_code"><![CDATA[
tmp_outdir = $(mktemp -d /interactomix/output-tools/VD2DOCK/XXXXXX)
PERL5LIB="/interactomix/bin-tool/VD2OCK:$PERL5LIB" perl run_vd2ock.pl 
$pdb_a
$pdb_b
$(dirname ${tmp_outdir})
$(basename ${tmp_outdir})
$tolerance
$scoring_function

cat $(ls ${tmp_outdir}/out_rot_* | grep -Ev -e ".*\.sp" -e ".*\.zr\.out") > $patchdock_scores
cat ${tmp_outdir}/out_rot*.sp > $splitpotential_scores
cat ${tmp_outdir}/out_rot*.zr.out > $zrank_scores
    
		]]></command>
	<environment_variables>
		<environment_variable name="TERM">linux</environment_variable>
	</environment_variables>
	<inputs>
		<param name="pdb_a" type="data" format="pdb" label="Protein A"/>
		<param name="pdb_b" type="data" format="pdb" label="Protein B"/>
		<param name="tolerance" type="select" label="Tolerance">
			<option value="0">0</option>
			<option value="0.2">0.2</option>
			<option value="0.4">0.4</option>
			<option value="0.6">0.6</option>
			<option value="0.8">0.8</option>
			<option value="1.0">1.0</option>
		</param>
		<param name="scoring_function" type="select" label="Scoring Function">
			<option value="0">PatchDock scores</option>
			<option value="1">PatchDock scores + Zrank</option>
			<option value="2">PatchDock scores + Split Potentials (ES3DC)</option>
			<option value="3">PatchDock scores + Zrank + Split Potentials (ES3DC)</option>
		</param>
	</inputs>
	<outputs>
		<data name="patchdock_scores"/>
		<data name="splitpotential_scores">
			<filter>scoring_function == "2" or scoring_function == "3"</filter>
		</data>
		<data name="zrank_scores">
			<filter>scoring_function == "1" or scoring_function == "3"</filter>
		</data>
	</outputs>
	<help><![CDATA[
]]>
	</help>
</tool>
